<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thank You | Boho Blackboard</title>

  <link rel="icon" type="image/png" href="bb favicon.png">
  <link rel="stylesheet" href="style.css">

  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

  <script>
    // Your EmailJS Public Key
    emailjs.init("_RstzO3AfSZ0UV3y7");
  </script>
</head>

<body>

<header>
  <h1 class="logo">Boho Blackboard</h1>
  <div class="swoosh"></div>
</header>

<section class="sub-banner">
  <img src="banner.png" alt="Payment Success Banner">
</section>

<main class="content" style="text-align:center;">
  <h2>Thank You for Your Purchase!</h2>
  <p>Your download links are being emailed to you now. ‚ù§Ô∏è</p>
  <p>If you do not receive an email within 2 minutes, please check your spam/junk folder.</p>

  <h3 id="status" style="margin-top:20px; color:#444;"></h3>
</main>

<footer>
  ¬© 2025 Boho Blackboard | Designed from the heart by Danielle Droste
</footer>

<script>
console.log("SUCCESS PAGE LOADED");

// Read URL parameters
const params = new URLSearchParams(window.location.search);
const customerEmail = params.get("email");
const productIDs = params.get("products"); // e.g. "DSH_EN,OWL_AF"

console.log("EMAIL:", customerEmail);
console.log("PRODUCT IDS:", productIDs);

// If nothing came through, stop
if (!customerEmail || !productIDs) {
  document.getElementById("status").innerText =
    "We could not generate your email. Please contact support.";
  throw new Error("Missing parameters");
}

// Convert CSV ‚Üí array
const idList = productIDs.split(",");

// DOWNLOAD LINKS mapped to IDs
const downloadLinks = {

  // Dachshunds
  "DSH_EN": "https://bohoblackboard.github.io/boho/downloads/boho-dachshunds-english.zip",
  "DSH_AF": "https://bohoblackboard.github.io/boho/downloads/boho-dachshunds-afrikaans.zip",

  // Bears
  "BRS_EN": "https://bohoblackboard.github.io/boho/downloads/boho-bears-english.zip",
  "BRS_AF": "https://bohoblackboard.github.io/boho/downloads/boho-bears-afrikaans.zip",

  // Bunnies
  "BUN_EN": "https://bohoblackboard.github.io/boho/downloads/boho-bunnies-english.zip",
  "BUN_AF": "https://bohoblackboard.github.io/boho/downloads/boho-bunnies-afrikaans.zip",

  // Owls
  "OWL_EN": "https://bohoblackboard.github.io/boho/downloads/boho-owls-english.zip",
  "OWL_AF": "https://bohoblackboard.github.io/boho/downloads/boho-owls-afrikaans.zip",

  // Ringnecks
  "RNG_EN": "https://bohoblackboard.github.io/boho/downloads/boho-ringnecks-english.zip",
  "RNG_AF": "https://bohoblackboard.github.io/boho/downloads/boho-ringnecks-afrikaans.zip",

  // Squirrels
  "SQR_EN": "https://bohoblackboard.github.io/boho/downloads/boho-squirrels-english.zip",
  "SQR_AF": "https://bohoblackboard.github.io/boho/downloads/boho-squirrels-afrikaans.zip"
};

// Build email text
let linkText = "";

idList.forEach(id => {
  if (downloadLinks[id]) {
    linkText += `${id}: ${downloadLinks[id]}\n`;
  }
});

console.log("EMAIL CONTENT:\n" + linkText);

// Send EmailJS email
emailjs.send("service_96euu0a", "template_wxt1tto", {
  customer_email: customerEmail,
  product_name: "Your Boho Blackboard Downloads",
  download_link: linkText
})
.then(() => {
  document.getElementById("status").innerText =
    "Your download email has been sent successfully! üéâ";
})
.catch(err => {
  console.error("EmailJS Error:", err);
  document.getElementById("status").innerText =
    "There was a problem sending your email. Please contact support.";
});
</script>

</body>
</html>
